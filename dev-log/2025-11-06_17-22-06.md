# Main Reviewer Log

- 시간: 2025-11-06 17:22:06 KST
- 대상 브랜치: main (HEAD d85a20ff)
- 리뷰 범위: 정보 검색/스크립트 생성 파이프라인 최신 병합분

## 주요 관찰
- 정보 파이프라인은 LLM 호출·dry_run·메타데이터까지 구현되어 있으나, CLI 예시(`python src/pipelines/info_retrieval.py ...`) 그대로 실행 시 모듈 경로 문제로 즉시 실패.
- 스크립트 파이프라인은 프롬프트 로더/메타데이터/드라이런 경로 구성이 정리되었지만, OpenAI 신규 클라이언트를 사용하면서 requirements와 충돌이 남아 있음.

## 발견 이슈
1. `src/pipelines/info_retrieval.py`를 직접 실행하면 `ModuleNotFoundError: No module named 'src'` 발생. 문서에 표기된 CLI 명령이 동작하지 않아 파이프라인 계약 위반.
2. 두 파이프라인 모두 `from openai import OpenAI` 기반으로 작성됐지만, `requirements.txt`는 `openai>=0.27.0`로 지정되어 있어 설치 환경에 따라 즉시 ImportError/AttributeError 발생 위험.

## 실행 테스트
- `python3 src/pipelines/info_retrieval.py --keyword "청자 상감운학문 매병" --dry-run --output-dir outputs/info` → ModuleNotFoundError (재현됨)
- `PYTHONPATH=. python3 src/pipelines/info_retrieval.py --keyword "청자 상감운학문 매병" --dry-run --output-dir outputs/info` → ✅ dry_run 성공, 산출물 및 메타데이터 생성 확인
- `PYTHONPATH=. python3 src/pipelines/script_gen.py --keyword "청자 상감운학문 매병" --dry-run --info-dir outputs/info --output-dir outputs/script` → ✅ dry_run 성공, 메타데이터 생성 확인
- `PYTHONPATH=. python3 src/pipelines/script_gen.py --list-prompts` → ✅ v1/v2 프롬프트 로딩 확인

## 후속 액션 제안
- 정보 파이프라인: 패키지 임포트 문제가 재발하지 않도록 `sys.path` 정리 혹은 `python -m` 사용 가이드 명시, CLI 예시 수정.
- 정보·스크립트 파이프라인 공통: OpenAI 의존성 버전을 `>=1.0.0`(또는 호환 코드 분기)로 맞추고, 실패 시 사용자 메시지 개선.
- 통합 테스트: dry_run 기반 info→script 체인을 자동화 스크립트로 추가하여 산출물 경로/메타데이터를 검증하도록 안내 예정.

## 커뮤니케이션 메모
- 각 파이프라인 에이전트에게 위 이슈 및 액션을 `docs/commands/` 하위 YAML로 공유 예정.

## 추가 결정 (2025-11-06 17:42 KST)
- 정보/스크립트 파이프라인 CLI는 `python -m src.pipelines.<module>` 형태로 통일하기로 확정.
- OpenAI SDK는 `openai>=1.0.0` 이상을 요구하며, 각 에이전트는 context7 MCP로 실 호출을 재검증하고 문법 오류를 최신 버전에 맞춰 수정해야 함.
- 관련 지시사항을 `docs/commands/info-retrieval.yaml`, `docs/commands/script-generation.yaml`에 반영 완료.
